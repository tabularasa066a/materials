# Capistranoの使い方

>## 概要
```
  Capistranoは、Rails製アプリなどの自動デプロイ(&サーバ操作)ツールのこと。
  コマンド数行でアプリをサーバへデプロイできる。
```

`デプロイ先のサーバとssh接続する。gitからcloneしたソースをそのサーバにデプロイしてくれる`

>## なぜデプロイを自動化するか
1. デプロイの要件
   - アプリケーションの構成要素
     - どんなプログラミング言語、フレームワークを使って開発されたのか
   - 実行環境や規模
     - どんなサーバ何台にデプロイする？
   - 許容時間
     - デプロイにどれくらい時間かける？
   - 納期
   - 予算

2. Capistranoを使う理由
- 手作業だと手順書書かなきゃだしめんどい
- シェルスクリプトで自動化ツール作ってもドキュメント作りとかある
- Capistranoなら英語に似た文法で設定ファイルを記述してあげれば、
  デプロイも細かな設定もすることができる。

>## Capistranoの初期設定
1. deploy対象のディレクトリに入る

2. ![初期設定](https://www.kumilog.net/entry/cap-deploy)
   - github上にリポジトリ作って、pushできることを確認しておくこと
   - サーバ側のホスト名やユーザ名に注意

>## Capistranoの使用
![参考](https://www.kumilog.net/entry/rails-cap)

>## その他
1. git cloneからデプロイを行う際自動でbundleインストールしてくれる設定

2. どのようなタスク(自動化したいタスク)を実行するかは`Capifile`に記述
   - タスクの追加は`lib/capistrano/tasks/`下に`.rake`ファイルを追加することで行う

3. deploy時にDBを作成しmigrationを行うタスクの作成

4. [演習用サイト](https://qiita.com/Salinger/items/4ee4f3c5ebd5227196c0)